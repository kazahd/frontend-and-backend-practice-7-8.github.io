<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Контакты - Семестровая работа</title>
    <link rel="stylesheet" href="../style/styles.css" />
    <script src="../scripts/theme.js"></script>
  </head>
  <body>
    <div class="page">
      <header class="page__header">
        <h1 class="page__header-title">Контакты</h1>
      </header>

      <nav class="page__nav">
        <ul class="nav__list">
          <li class="nav__item">
            <a class="nav__link" href="../index.html">Главная</a>
          </li>
          <li class="nav__item">
            <a class="nav__link" href="news.html">Новости</a>
          </li>
          <li class="nav__item">
            <a class="nav__link" href="practices.html">Практики</a>
          </li>
          <li class="nav__item">
            <a class="nav__link" href="goods.html">Товары</a>
          </li>
          <li class="nav__item">
            <a class="nav__link nav__link--active" href="contacts.html"
              >Контакты</a
            >
          </li>
        </ul>
      </nav>

      <main class="page__main">
        <section class="contacts">
          <h2 class="contacts__title">Наши контакты</h2>

          <div class="contacts__grid">
            <article class="contact__info">
              <h3 class="contact__info-title">Электронная почта</h3>
              <p>Адрес электронной почты: pudge@email.com</p>
            </article>

            <article class="contact__info">
              <h3 class="contact__info-title">Физический адрес</h3>
              <p>Адрес: г. Москва, ул. Мидовая, д. 322, Бизнес-центр "Hook"</p>
            </article>

            <div class="contact__details">
              <div class="contact__detail">
                <h3 class="contact__detail-title">Телефон</h3>
                <p class="contact__detail-text">+7 (495) 123-45-67</p>
              </div>
              <div class="contact__detail">
                <h3 class="contact__detail-title">Время работы</h3>
                <p class="contact__detail-text">Пн-Пт: 9:00-18:00</p>
              </div>
              <div class="contact__detail">
                <h3 class="contact__detail-title">Социальные сети</h3>
                <p class="contact__detail-text">VK, Telegram, WhatsApp</p>
              </div>
            </div>
          </div>

          <button class="contact__button" onclick="contactModal.showModal()">
            Связаться с нами
          </button>
        </section>
      </main>

      <footer class="page__footer">
        <p class="page__footer-text">Все права защищены</p>
      </footer>

      <dialog id="contactModal" class="dialog">
        <div class="dialog__header">
          <h2 class="dialog__title">Форма обратной связи</h2>
        </div>

        <div class="dialog__content">
          <form id="feedbackForm">
            <div class="form__group">
              <label for="name" class="form__label"
                >Имя <span class="form__required">*</span></label
              >
              <input
                type="text"
                id="name"
                name="name"
                class="form__input"
                required
                placeholder="Введите ваше имя"
                minlength="2"
                maxlength="50"
                pattern="[A-Za-zА-Яа-яЁё\s]+"
                title="Имя должно содержать только буквы и пробелы"
              />
              <span class="validation__message" id="nameError"></span>
            </div>

            <div class="form__group">
              <label for="phone" class="form__label"
                >Телефон <span class="form__required">*</span></label
              >
              <input
                type="tel"
                id="phone"
                name="phone"
                class="form__input"
                required
                placeholder="+7 (XXX) XXX-XX-XX"
                pattern="\+7\s?[\(]?\d{3}[\)]?\s?\d{3}[\-]?\d{2}[\-]?\d{2}"
                title="Формат: +7 (XXX) XXX-XX-XX"
              />
              <span class="validation__message" id="phoneError"></span>
            </div>

            <div class="form__group">
              <label for="email" class="form__label"
                >Электронная почта <span class="form__required">*</span></label
              >
              <input
                type="email"
                id="email"
                name="email"
                class="form__input"
                required
                placeholder="example@mail.ru"
                pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}"
                title="Введите корректный email адрес"
              />
              <span class="validation__message" id="emailError"></span>
            </div>

            <div class="form__group">
              <label for="category" class="form__label"
                >Категория обращения
                <span class="form__required">*</span></label
              >
              <select
                id="category"
                name="category"
                class="form__select"
                required
              >
                <option value="">Выберите категорию</option>
                <option value="technical">Техническая поддержка</option>
                <option value="commercial">Коммерческое предложение</option>
                <option value="cooperation">Сотрудничество</option>
                <option value="complaint">Жалоба</option>
                <option value="suggestion">Предложение</option>
                <option value="other">Другое</option>
              </select>
              <span class="validation__message" id="categoryError"></span>
            </div>

            <div class="form__group">
              <label for="message" class="form__label"
                >Текст обращения <span class="form__required">*</span></label
              >
              <textarea
                id="message"
                name="message"
                class="form__textarea"
                required
                placeholder="Опишите вашу проблему или вопрос..."
                minlength="10"
                maxlength="1000"
                title="Сообщение должно содержать от 10 до 1000 символов"
              ></textarea>
              <span class="validation__message" id="messageError"></span>
            </div>

            <div class="form__actions">
              <button
                type="button"
                class="button button--secondary"
                onclick="cancelForm()"
              >
                Отмена
              </button>
              <button
                type="button"
                class="button button--primary"
                onclick="submitForm()"
              >
                Отправить
              </button>
            </div>
          </form>
        </div>
      </dialog>

      <script>
        // Функции валидации остаются без изменений
        function validateForm() {
          let isValid = true;
          const name = document.getElementById("name");
          const phone = document.getElementById("phone");
          const email = document.getElementById("email");
          const category = document.getElementById("category");
          const message = document.getElementById("message");

          clearErrors();

          if (!name.value.trim()) {
            showError("nameError", "Имя обязательно для заполнения");
            isValid = false;
          } else if (!/^[A-Za-zА-Яа-яЁё\s]+$/.test(name.value.trim())) {
            showError("nameError", "Имя должно содержать только буквы");
            isValid = false;
          } else if (name.value.trim().length < 2) {
            showError("nameError", "Имя должно содержать минимум 2 символа");
            isValid = false;
          }

          if (!phone.value.trim()) {
            showError("phoneError", "Телефон обязателен для заполнения");
            isValid = false;
          } else if (
            !/\+7\s?[\(]?\d{3}[\)]?\s?\d{3}[\-]?\d{2}[\-]?\d{2}/.test(
              phone.value.trim()
            )
          ) {
            showError("phoneError", "Формат телефона: +7 (XXX) XXX-XX-XX");
            isValid = false;
          }

          if (!email.value.trim()) {
            showError("emailError", "Email обязателен для заполнения");
            isValid = false;
          } else if (
            !/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(
              email.value
            )
          ) {
            showError("emailError", "Введите корректный email адрес");
            isValid = false;
          }

          if (!category.value) {
            showError("categoryError", "Выберите категорию обращения");
            isValid = false;
          }

          if (!message.value.trim()) {
            showError("messageError", "Сообщение обязательно для заполнения");
            isValid = false;
          } else if (message.value.trim().length < 10) {
            showError(
              "messageError",
              "Сообщение должно содержать минимум 10 символов"
            );
            isValid = false;
          } else if (message.value.trim().length > 1000) {
            showError(
              "messageError",
              "Сообщение не должно превышать 1000 символов"
            );
            isValid = false;
          }

          return isValid;
        }

        function showError(elementId, message) {
          const errorElement = document.getElementById(elementId);
          errorElement.textContent = message;
          errorElement.style.display = "block";

          const inputElement = errorElement.previousElementSibling;
          if (inputElement) {
            inputElement.style.borderColor = "var(--color-danger)";
          }
        }

        function clearErrors() {
          const errorElements = document.querySelectorAll(
            ".validation__message"
          );
          errorElements.forEach((element) => {
            element.textContent = "";
            element.style.display = "none";
          });

          const inputElements = document.querySelectorAll(
            ".form__input, .form__select, .form__textarea"
          );
          inputElements.forEach((element) => {
            element.style.borderColor = "var(--color-bg-tertiary)";
          });
        }

        function clearForm() {
          document.getElementById("feedbackForm").reset();
          clearErrors();
        }

        function cancelForm() {
          clearForm();
          contactModal.close();
        }

        function submitForm() {
          if (!validateForm()) {
            return;
          }

          const form = document.getElementById("feedbackForm");
          const formData = new FormData(form);

          const data = {
            name: formData.get("name"),
            phone: formData.get("phone"),
            email: formData.get("email"),
            category: formData.get("category"),
            message: formData.get("message"),
          };

          console.log("Данные формы:", data);

          alert(
            "Спасибо! Ваше обращение отправлено. Мы свяжемся с вами в ближайшее время."
          );

          contactModal.close();

          clearForm();
        }

        document.addEventListener("DOMContentLoaded", function () {
          const inputs = document.querySelectorAll(
            "#feedbackForm .form__input, #feedbackForm .form__select, #feedbackForm .form__textarea"
          );

          inputs.forEach((input) => {
            input.addEventListener("blur", function () {
              validateForm();
            });

            input.addEventListener("input", function () {
              const errorId = this.id + "Error";
              const errorElement = document.getElementById(errorId);
              if (errorElement) {
                errorElement.textContent = "";
                errorElement.style.display = "none";
                this.style.borderColor = "var(--color-bg-tertiary)";
              }
            });
          });
        });

        document
          .getElementById("contactModal")
          .addEventListener("click", function (event) {
            if (event.target === this) {
              cancelForm();
            }
          });
      </script>
    </div>
  </body>
</html>
